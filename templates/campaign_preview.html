{% extends "base.html" %}
{% block content %}

<div style="margin-bottom: 20px;">
  <a href="{{ url_for('main.dashboard') }}" style="color: #007bff; text-decoration: none;">â† Back to Dashboard</a>
</div>

<h2>Campaign Preview</h2>

<div style="background: #f0f8ff; padding: 15px; border-radius: 4px; margin-bottom: 20px;">
  <strong>ğŸ“§ Subject:</strong> {{ campaign.subject }}<br>
  <strong>ğŸ“‹ Target:</strong> {{ target }}<br>
  <strong>ğŸ‘¥ Recipients:</strong> <span style="background: #e7f3ff; padding: 4px 8px; border-radius: 3px;">{{ contact_count }} contacts</span><br>
  <strong>Status:</strong> {{ campaign.status }}
</div>

{% if contact_count > 0 %}
  <div style="margin-bottom: 20px;">
    <h3>Email Preview</h3>
    <div style="border: 1px solid #ddd; padding: 20px; background: white; border-radius: 4px;">
      {{ campaign.body_html|safe }}
    </div>
  </div>

  <div style="margin-bottom: 20px;">
    <h3>Recipients ({{ contact_count }} total)</h3>
    <div style="max-height: 300px; overflow-y: auto; border: 1px solid #ddd; border-radius: 4px; background: white;">
      <table style="width: 100%; border-collapse: collapse;">
        <tbody>
          {% for contact in contacts[:20] %}
          <tr style="border-bottom: 1px solid #f0f0f0;">
            <td style="padding: 8px 12px;">{{ contact.email }}</td>
          </tr>
          {% endfor %}
          {% if contacts|length > 20 %}
          <tr style="background: #f5f5f5;">
            <td style="padding: 12px; text-align: center; color: #666;">... and {{ contacts|length - 20 }} more</td>
          </tr>
          {% endif %}
        </tbody>
      </table>
    </div>
  </div>

  <div style="display: flex; gap: 10px;">
    <a href="{{ url_for('main.send_campaign', id=campaign.id) }}" style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; text-decoration: none; display: inline-block; font-size: 16px;">âœ“ Send Campaign</a>
    <a href="{{ url_for('main.edit_campaign_group', id=campaign.id) }}" style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; text-decoration: none; display: inline-block; font-size: 16px;">ğŸ“‹ Change Target</a>
    <a href="{{ url_for('main.dashboard') }}" style="padding: 10px 20px; background: #6c757d; color: white; border: none; border-radius: 4px; cursor: pointer; text-decoration: none; display: inline-block;">Cancel</a>
  </div>
{% else %}
  <div style="background: #fff3cd; padding: 15px; border-radius: 4px; border: 1px solid #ffc107;">
    <strong>âš ï¸ No recipients found!</strong> The selected target has no subscribed contacts. 
    <a href="{{ url_for('main.edit_campaign_group', id=campaign.id) }}">Change target</a>
  </div>
{% endif %}

{% endblock %}
